---
title: "EDA"
output: html_document
date: "2025-11-04"
---

Right off the bat, we found that this data set included binary variables that needed to be converted into numbers in stead of words. Therefore that is the first step, was to convert these values. Next we randomized the dataset so that it only has the required 200 cases. 
```{r setup, include=FALSE}

library(rmarkdown); library(knitr); library(moments); 
library(scatterplot3d); library(corrplot); library(pso)
library(psych); library(GPArotation); library(lavaan)



knitr::opts_chunk$set(echo = TRUE)

dataset <- read.csv("personality_datasert.csv")

# 

dataset$Personality <- as.numeric(factor(dataset$Personality, level = c("Introvert", "Extrovert"))) - 1

dataset$Drained_after_socializing <- as.numeric(factor(dataset$Drained_after_socializing, level = c("No", "Yes"))) - 1

dataset$Stage_fear <- as.numeric(factor(dataset$Stage_fear, level = c("No", "Yes"))) - 1


dataset
set.seed(123)  # optional for reproducibility
df_sample <- dataset[sample(nrow(dataset), 200), ]
```


Next, since the criteria was to do an analysis separate for the predictive variables and the response variables, we separated our dataset into two tables, one for the response variables and one for the predictive. We then found the correlation of each table so that we can use for further analysis. 

```{r}
response <- df_sample$Personality

# Predictor variables
predictive <- df_sample[, c("Time_spent_Alone",
                            "Drained_after_socializing",
                            "Post_frequency",
                            "Friends_circle_size",
                            "Going_outside"
                            )]


response <- df_sample[, c("Personality", "Stage_fear", "Social_event_attendance")]

res <- cor(response)
pre <- cor(predictive)

corrplot(res)
corrplot(pre)
eigen(res)
eigen(pre)


#predective "time spent alone" due to kaisers rule 
#response we keep personality due to kaisers
# use a heat map with the coorepation matrix
```



After looking at the eigen values, we can use Kaisers criterion, we can see that for both the the Responsive and the Predictive variables, have an intrinsic dimensional of 1. Therefore we ran the PCA() function to find the optimally orthogonality loading matrix, for both the Responsive variables and the Predictive variables.


```{r}

res_opt <- pca(r = res, nfactors = 1, rotate = "varimax")$loadings[]
res_opt

pre_opt <- pca(r = pre, nfactors = 1, rotate = "varimax")$loadings[]
pre_opt


```
Since we are only using one factor, it seems to be a bit unnecessary to do the roational matrix on either of them. Therefore, we look at al alternative, what would happen if we used 2 factors instead of just 1. 


```{r}
res_opt <- pca(r = res, nfactors = 2, rotate = "varimax")$loadings[]
res_opt

pre_opt <- pca(r = pre, nfactors = 2, rotate = "varimax")$loadings[]
pre_opt


corrplot(res_opt)
corrplot(pre_opt)
```



By using two factors, we can see that for the response variables, we have 2 complex dimensions (following the 0.30 threshold): Stage_fear & Social_event_attendance. For Predictive variables, we have 2 complex dimensions: Time_spent_alone & Drained_after_socializing. 

Knowing this information, we can also do an obliquely rotated loading matrix to see if we can get rid of those complex dimensions. 
```{r}
res_opt <- pca(r = res, nfactors = 2, rotate = "oblimin")$loadings[]
res_opt

pre_opt <- pca(r = pre, nfactors = 2, rotate = "oblimin")$loadings[]
pre_opt
```

By doing this Obliquely rotated matrix, we got rid of a lot of complex dimensions. For response variables, we completely got rid of the complex dimensions. For the predictive variables, we are left with 1 complex dimension: Time_spend_alone. 

Now,  we understand that it is not necessary to use 2 factors, since the results from using 1 factor tells us that all the variables are correlated with each other. However, to understand if the oblique rotation using 2 factors was necessary we need to get the full summary. 
```{r}
pre_opt <- pca(r = pre, nfactors = 2, rotate = "oblimin")
pre_opt

res_opt <- pca(r = res, nfactors = 2, rotate = "oblimin")
res_opt


```
Looking at the correlation component, we can see that it is far beyond the threshold of 0.30, sitting at 0.76. which means that a Oblique rotation was indeed necessary in this analysis. 


When looking at the commonalities, we can observe that all of them are very high, with the lowest being 79.01% which is very good.

Overall,the predictive variables have a variance between 79-95%, meaning all the variables very much correlate with each other. Similarly, the Response variables have a variance between 92-99% across all variables, also very much correlating with each other.